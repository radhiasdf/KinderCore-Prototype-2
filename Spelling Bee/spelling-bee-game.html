<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TMM97RHP9P"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TMM97RHP9P');
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spelling Bee Game</title>
  <link rel="icon" href="../icons/spellingbeeicon.png" type="image/png">

  <link rel="stylesheet", href="../back-button.css">
  <style>
    body {
      font-family: sans-serif;
      background: #fffbea;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 1rem;
    }
    
    #gameArea {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin: 0;
      padding: 1rem;
    }
    .hex {
      width: 50px;
      height: 50px;
      background: white;
      border: 2px solid #e0a106;
      clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 5px;
      transition: background 0.3s;
    }
    .filled {
      background: orange;
      color: white;
    }
    .hex-space {
      width: 40px; /* same size as .hex */
      height: 40px;
      margin: 4px;
      display: inline-block;
    }
    #highScore {
      font-size: 1rem;
      color: #888;
    }
    #gameOver {
      display: none;
      text-align: center;
      margin-top: 2rem;
    }
    #gameOver h2 {
      color: #c00;
    }
    .score-icon {
      display: inline-flex;
      align-items: center;
      font-size: 1.2em;
      margin-top: 1rem;
    }
    .score-icon svg {
      fill: #e0a106;
      width: 1.2em;
      height: 1.2em;
      margin-right: 0.3em;
    }
    #timer {
      font-size: 1.2em;
      display: flex;
      align-items: center;
    }
    .hex-container {
      display: flex;
      justify-content: center;
      margin: 1em 0;
      flex-wrap: wrap;
    }
    .fly {
      animation: flyToScore 1s forwards;
    }
    @keyframes flyToScore {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(-100px); opacity: 0; }
    }
    input[type="text"] {
      font-size: 1.3em;
      padding: 0.5em;
      width: 80%;
      max-width: 400px;
      text-align: center;
      border-radius: 8px;
      border-color: grey;
      border-style: solid;
    }
    select, button {
      margin-top: 1rem;
      font-size: 1.3em;
      padding: 0.4em 0.8em;
    }
    .back-button {
      position: absolute;
      background-color: darkorange !important;
      color: white;
      font-weight: bold;
    }

    #theme-container {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      justify-content: center;
    }

    .card {
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      padding: 20px;
      width: 120px;
      height: 120px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.2s, background 0.3s;
    }

    .card:hover {
      transform: scale(1.05);
    }

    .card.selected {
      background: #d4f5d4;
      border: 2px solid #4caf50;
    }

    .emoji {
      font-size: 32px;
      margin-bottom: 10px;
    }

    .label {
      font-weight: bold;
      font-size: 16px;
    }


  </style>
  
</head>
<body>
  <div id="empty-box">
    <button class="back-button" onclick="window.history.length > 1 ? history.back() : window.location.href='index.html'">
      ‚¨Ö Back
    </button>
  </div>


  <h1>Spelling Bee Game</h1>
  <div id="highScore">High Score: <span id="highScoreValue">0</span></div>
  
  <div id="startScreen">
    <button id="startButton">Start Game</button>
  </div>
  

  <div id="gameArea">
    <div id="gameOver">
      <h2>Game Over</h2>
      <p>Your score: <span id="finalScore"></span></p>
      <button onclick="restartGame()">Play Again</button>
    </div>
    
    <div style="display: flex; align-items: center; gap: 50px">
      <div class="score-icon">
        <svg viewBox="0 0 24 24">
          <polygon points="12,2 22,9 22,21 12,22 2,21 2,9" />
        </svg>
        <span id="score">0</span>
      </div>
      <div class="score-icon">
        ‚è±Ô∏è <span id="timer">Time: 60</span>
      </div>
    </div>
    
    
    <div id="hintImage" style="font-size: 5rem;">üî§</div>
    <div class="hex-container" id="hexContainer"></div>
    <input type="text" id="wordInput" placeholder="Type the word..." />
    <button id="skipButton">Skip</button>
  </div>
  



  <select id="difficulty">
    <option value="easy">Easy</option>
    <option value="medium">Medium</option>
    <option value="hard">Hard</option>
  </select>

  <h1>Select Themes to Practice</h1>
  <div id="theme-container"></div>

  <audio id="correctSound" src="correct-6033.mp3"></audio>

  <script src="wordlist.js"></script>

  <script>

    let score = 0;
    let highScore = parseInt(localStorage.getItem('bestSpelling')) || 0;
    let currentIndex = 0;
    let timeLeft = 60;
    let countdownInterval;
    let currentLanguage = "en";


    const hexContainer = document.getElementById('hexContainer');
    const wordInput = document.getElementById('wordInput');
    const scoreDisplay = document.getElementById('score');
    const highScoreDisplay = document.getElementById('highScoreValue');
    const timer = document.getElementById('timer');
    const hintImage = document.getElementById('hintImage');
    const correctSound = document.getElementById('correctSound');
    const wrongSound = document.getElementById('wrongSound');
    const difficultySelect = document.getElementById('difficulty');
    const gameOverScreen = document.getElementById('gameOver');
    const finalScoreDisplay = document.getElementById('finalScore');

    highScoreDisplay.textContent = highScore;

    /////////////////// THEMES AND WORDS //////////////////////////////////
    

    const container = document.getElementById("theme-container");

    let selectedThemes = JSON.parse(localStorage.getItem("selectedThemes")) || [];

    function saveSelection() {
      localStorage.setItem("selectedThemes", JSON.stringify(selectedThemes));
    }

    function renderThemes() {
      container.innerHTML = "";
      themes.forEach((theme, index) => {
        const card = document.createElement("div");
        card.className = "card";
        if (selectedThemes.includes(index)) card.classList.add("selected");

        card.innerHTML = `
          <div class="emoji">${theme.emoji}</div>
          <div class="label">${theme.name}</div>
        `;

        card.addEventListener("click", () => {
          if (selectedThemes.includes(index)) {
            selectedThemes = selectedThemes.filter(i => i !== index);
          } else {
            selectedThemes.push(index);
          }
          saveSelection();
          renderThemes();
          generateWordPool();
          loadWord(); // reload word from updated list
        });


        container.appendChild(card);
      });
    }

    let words = [];

    function generateWordPool() {
      words = [];
      selectedThemes.forEach(index => {
        const theme = themes[index];
        theme.words.forEach(entry => {
          const [word, emoji] = entry.split(' ');
          words.push({ word, emoji });
        });
      });
    }

      function loadWord() {
        let filteredWords = words.filter(w => {
          const cleanWord = w.word.replace(/[^a-zA-Z- ]/g, ''); // Remove non-letter characters, keeping spaces and dashes
          const len = cleanWord.replace(/-/g, ' ').length; // Adjust length to treat dashes as spaces
          if (difficultySelect.value === 'easy') return len <= 4;
          if (difficultySelect.value === 'medium') return len > 4 && len <= 6;
          return len > 6;
        });

        if (filteredWords.length === 0) {
          hintImage.textContent = '‚ùì';
          hexContainer.innerHTML = '<div class="message">No words for this difficulty</div>';
          return;
        }

        const random = Math.floor(Math.random() * filteredWords.length);
        const { word, emoji } = filteredWords[random];
        currentIndex = words.findIndex(w => w.word === word);
        hintImage.textContent = emoji;
        hexContainer.innerHTML = '';

        // Replace dashes with spaces for hexagon display
        const displayWord = word.replace(/-/g, ' '); // Replace dashes with spaces

        // Create hexagons for the word with spaces
        for (let char of displayWord) {
          const hex = document.createElement('div');
          if (char === ' ') {
            hex.classList.add('hex-space');
            hex.style.visibility = 'hidden'; // Hide space hexagons
          } else {
            hex.classList.add('hex');
          }
          hexContainer.appendChild(hex);
        }
      }



    wordInput.addEventListener('input', () => {
      const input = wordInput.value.toLowerCase();
      const currentWord = words[currentIndex].word;
      const hexes = hexContainer.children;
      for (let i = 0; i < hexes.length; i++) {
        hexes[i].textContent = input[i] ? input[i].toUpperCase() : '';
        if (input[i]) hexes[i].classList.add('filled');
        else hexes[i].classList.remove('filled');
      }

      if (input === currentWord.replace(/-/g, ' ')) {
        correctSound.play();
        Array.from(hexes).forEach(hex => hex.classList.add('fly'));
        setTimeout(() => {
          score += input.length;
          scoreDisplay.textContent = score;
          if (score > highScore) {
            highScore = score;
            highScoreDisplay.textContent = highScore;
            localStorage.setItem('bestSpelling', highScore);
          }
          wordInput.value = '';
          loadWord();
        }, 1000);
      } else if (input.length === currentWord.length && input !== currentWord) {
        wrongSound.play();
      }
    });

    document.getElementById('skipButton').addEventListener('click', () => {
      wordInput.value = '';
      loadWord();
    });

    function countdown() {
      countdownInterval = setInterval(() => {
        timeLeft--;
        timer.textContent = `Time: ${timeLeft}`;
        if (timeLeft <= 0) {
          clearInterval(countdownInterval);
          endGame();
        }
      }, 1000);
    }

    function endGame() {
      wordInput.disabled = true;
      document.getElementById('skipButton').disabled = true;
      gameOverScreen.style.display = 'block';
      finalScoreDisplay.textContent = score;
    }

    function restartGame() {
      score = 0;
      timeLeft = 60;
      wordInput.disabled = false;
      document.getElementById('skipButton').disabled = false;
      gameOverScreen.style.display = 'none';
      wordInput.value = '';
      scoreDisplay.textContent = 0;
      timer.textContent = `Time: ${timeLeft}`;
      loadWord();
      countdown();
    }

    const startScreen = document.getElementById('startScreen');
      const startButton = document.getElementById('startButton');
      const gameArea = document.getElementById('gameArea');

      startButton.addEventListener('click', () => {
        startScreen.style.display = 'none';
        gameArea.style.display = 'flex';
        startGame();
      });

      function startGame() {
        score = 0;
        timeLeft = 60;
        scoreDisplay.textContent = 0;
        timer.textContent = `Time: ${timeLeft}`;
        wordInput.disabled = false;
        document.getElementById('skipButton').disabled = false;
        wordInput.value = '';
        gameOverScreen.style.display = 'none';
        generateWordPool();
        loadWord();
        countdown();
      }

      renderThemes();
  </script>
</body>
</html>

    
    
    
    
    
    